<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>
   CG || Code Sharing
  </title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&amp;display=swap" rel="stylesheet"/>
  <style>
   body {
      font-family: 'Inter', sans-serif;
    }
    /* Custom scrollbar for textarea */
    textarea::-webkit-scrollbar {
      width: 8px;
    }
    textarea::-webkit-scrollbar-thumb {
      background-color: #3b82f6;
      border-radius: 4px;
    }
  </style>
 </head>
 <body class="bg-gray-900 min-h-screen flex flex-col p-6 transition-colors duration-500 text-gray-100">
  <header class="flex justify-start items-center mb-6 space-x-4">
   <img alt="logo jawa" class="rounded-lg shadow-md w-16 h-16 object-cover" height="64" src="https://cloudgood.xyz/file/KsG8bq7.png" width="64"/>
   <h1 class="text-3xl font-extrabold tracking-tight select-none">
    CodeGood
   </h1>
  </header>
  <main class="w-full max-w-3xl bg-gray-800 rounded-2xl shadow-lg p-10 sm:p-12 md:p-16 transition-colors duration-500 mx-auto flex-grow">
   <header class="mb-10 text-center">
    <h1 class="text-4xl font-extrabold tracking-tight">
     Share Your Code
    </h1>
    <p class="mt-2 max-w-md mx-auto text-gray-300">
     Quickly create sharable links for your code snippets with syntax highlighting support.
    </p>
   </header>
   <form autocomplete="off" class="space-y-8" id="pasteForm" novalidate="" spellcheck="false">
    <div>
     <label class="block text-sm font-semibold mb-2" for="name">
      Feature Name
     </label>
     <input aria-describedby="name-desc" class="w-full rounded-lg border border-gray-600 bg-gray-700 px-4 py-3 text-gray-100 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition" id="name" maxlength="100" name="name" placeholder="Enter feature name" required="" type="text"/>
     <p class="mt-1 text-xs text-gray-400" id="name-desc">
      Give your code snippet a descriptive name.
     </p>
    </div>
    <div>
     <label class="block text-sm font-semibold mb-2" for="code">
      Code Snippet
     </label>
     <textarea aria-describedby="code-desc" class="w-full rounded-lg border border-gray-600 bg-gray-700 px-4 py-3 font-mono text-gray-100 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition resize-y" id="code" name="code" placeholder="Paste your code here..." required="" rows="12"></textarea>
     <p class="mt-1 text-xs text-gray-400" id="code-desc">
      Make sure your code is properly formatted before submitting.
     </p>
    </div>
    <button class="w-full flex justify-center items-center gap-3 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white font-semibold rounded-lg px-6 py-3 transition focus:outline-none focus:ring-4 focus:ring-blue-300" type="submit">
     <i class="fas fa-link fa-lg">
     </i>
     Create Link
    </button>
   </form>
   <section class="mt-10 text-center font-medium break-words text-blue-500" id="result"></section>
  </main>
  <footer class="mt-12 text-center text-gray-400 text-sm select-none">
   Â© 2025 CodeGood. All rights reserved.
  </footer>
  <script>
   const result = document.getElementById('result');
   const form = document.getElementById('pasteForm');

   form.addEventListener('submit', async (e) => {
     e.preventDefault();
     result.textContent = '';
     const formData = new FormData(form);
     const data = Object.fromEntries(formData);

     try {
       const response = await fetch('/api/create', {
         method: 'POST',
         headers: { 'Content-Type': 'application/json' },
         body: JSON.stringify(data),
       });

       if (!response.ok) {
         throw new Error(`Server error: ${response.statusText}`);
       }

       const json = await response.json();

       result.innerHTML = `
         <p class="mb-2 text-gray-300">Your code link is ready:</p>
         <a href="/view/${json.id}" target="_blank" rel="noopener noreferrer" class="inline-block text-blue-400 underline break-all hover:text-blue-300 transition">
           ${location.origin}/view/${json.id}
         </a>
       `;
       result.classList.remove('text-red-600', 'dark:text-red-500');
       result.classList.add('text-blue-400');
       form.reset();
     } catch (error) {
       result.textContent = `Failed to create link: ${error.message}`;
       result.classList.remove('text-blue-400');
       result.classList.add('text-red-600');
     }
   });
  </script>
 </body>
</html>
